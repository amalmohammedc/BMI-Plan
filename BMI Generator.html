<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nutryfit Print Report</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Tailwind gray-100 */
        }
        /* Custom Nutryfit Green Colors */
        .nutryfit-dark-green { color: #2a552a; }
        .nutryfit-light-green { color: #5a8b5a; }
        .bg-nutryfit-dark-green { background-color: #2a552a; }
        .bg-nutryfit-light-green { background-color: #5a8b5a; }
        .hover\:bg-nutryfit-darker-green:hover { background-color: #214221; }
        
        /* A4 Page Simulation */
        .print-page {
            width: 210mm;
            min-height: 297mm;
            padding: 20mm;
            margin: 2rem auto;
            background: white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
            border-radius: 8px;
        }

        /* Remove spinners from number inputs */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        
        /* Default Input Styling */
        .form-input {
            border: 1px solid #d1d5db; /* gray-300 */
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.5rem 0.75rem;
        }
        .form-input-clean {
             border: none;
             background: transparent;
        }
        .form-input-clean:focus {
            outline: none;
        }

        /* Print-Specific Styles */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                background-color: white;
                margin: 0;
                padding: 0;
            }
            .no-print {
                display: none !important;
            }
            .print-page {
                width: 100%;
                min-height: auto;
                margin: 0;
                padding: 0;
                box-shadow: none !important;
                border-radius: 0;
            }
            /* Style for inputs on print */
            .print-input, .print-select {
                border: none !important;
                background-color: transparent !important;
                box-shadow: none !important;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                padding: 0;
                margin: 0;
                color: inherit !important; /* Ensure text color is inherited */
            }
            /* Hide placeholders on print */
            .print-input::placeholder {
                color: transparent;
            }
            /* Specific print color for red advice text */
            .text-red-800 .print-input {
                color: #991b1b !important;
            }
        }
        @page {
            size: A4;
            margin: 20mm;
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">

    <!-- Print Button (Hidden on Print) --><div class="max-w-4xl mx-auto text-center mb-4 no-print flex justify-center gap-4">
        <button id="calculate-button" class="bg-nutryfit-dark-green hover:bg-nutryfit-darker-green text-white font-bold py-3 px-6 rounded-full transition duration-300 text-lg">
            Calculate BMI
        </button>
        <button onclick="window.print()" class="bg-nutryfit-light-green hover:bg-nutryfit-darker-green text-white font-bold py-3 px-6 rounded-full transition duration-300 text-lg">
            üñ®Ô∏è Print This Report
        </button>
    </div>

    <!-- A4 Page Container --><div class="print-page">
        <!-- Header --><header class="pb-6 flex items-center justify-between border-b-2 border-gray-100">
            <div>
                 <img src="https://www.nutryfit.in/_next/static/media/logo.37bb63b3.svg" alt="Nutryfit Logo" class="h-16">
            </div>
            <div class="text-right">
                <h1 class="text-3xl font-bold nutryfit-dark-green">BMI Report</h1>
            </div>
        </header>

        <main class="space-y-8 mt-8">
            <!-- Client Details --><section id="client-details" class="p-6 rounded-lg" style="background-color: #E9FDF2;">
                <div class="mb-4">
                    <label for="name-input" class="font-medium text-gray-700 no-print" style="width: 80px;">Name:</label>
                    <input type="text" id="name-input" class="font-bold nutryfit-dark-green text-lg p-1 print-input form-input-clean w-3/4" placeholder="Enter Name">
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-lg">
                    <div class="flex items-center">
                        <label for="age-input" class="font-medium text-gray-700 no-print" style="width: 80px;">Age:</label>
                        <input type="number" id="age-input" class="font-bold nutryfit-dark-green text-lg p-1 print-input form-input-clean w-24" placeholder="35">
                    </div>
                    <div class="flex items-center">
                        <label for="gender-select" class="font-medium text-gray-700 no-print" style="width: 80px;">Gender:</label>
                        <select id="gender-select" class="font-bold nutryfit-dark-green text-lg p-1 print-select form-input-clean w-32">
                            <option value="male">Male</option>
                            <option value="female">Female</option>
                        </select>
                    </div>
                </div>
            </section>

            <!-- Body Composition (Central Graphic) --><section id="bmi-analysis">
                <h2 class="text-xl font-semibold text-gray-800 border-b pb-2 mb-4">Body Mass Index Analysis</h2>
                <div class="bg-white p-6 rounded-lg border border-gray-100">
                    <div class="grid grid-cols-2 gap-6 text-center mb-6">
                         <div class="flex items-center justify-center">
                            <label for="weight-input" class="block font-medium text-gray-700 no-print mr-2">Weight:</label>
                            <input type="number" id="weight-input" class="text-3xl font-bold nutryfit-dark-green mb-1 print-input form-input-clean w-24 text-center" placeholder="87" min="20" max="200" step="0.1">
                            <span class="text-3xl font-bold nutryfit-dark-green mb-1">kg</span>
                        </div>
                        <div class="flex items-center justify-center">
                            <label for="height-input" class="block font-medium text-gray-700 no-print mr-2">Height:</label>
                            <input type="number" id="height-input" class="text-3xl font-bold nutryfit-dark-green mb-1 print-input form-input-clean w-24 text-center" placeholder="164" min="100" max="250" step="0.1">
                            <span class="text-3xl font-bold nutryfit-dark-green mb-1">cm</span>
                        </div>
                    </div>
                    
                    <!-- BMI Result --><div class="text-center p-4 rounded-lg bg-red-100 text-red-800" id="bmi-result-bg">
                        <p class="text-sm font-medium" id="bmi-category-text">Obese Class I</p>
                        <p class="text-4xl font-bold" id="bmi-value-text">32.3</p>
                        <p class="text-xs">Body Mass Index (BMI)</p>
                    </div>

                    <!-- BMI Bar Chart --><div class="mt-6">
                        <div class="w-full bg-gray-200 rounded-full h-2.5 relative">
                            <div class="bg-blue-500 h-2.5 rounded-l-full" style="width: 10.42%;"></div>
                            <div class="bg-nutryfit-light-green h-2.5 absolute top-0" style="left: 10.42%; width: 27.08%;"></div>
                            <div class="bg-orange-500 h-2.5 absolute top-0" style="left: 37.5%; width: 20.83%;"></div>
                            <div class="bg-red-500 h-2.5 rounded-r-full absolute top-0" style="left: 58.33%; width: 41.67%;"></div>
                            <!-- BMI Marker - will be positioned by JS --><div id="bmi-marker" class="absolute top-1/2 -translate-y-1/2 -translate-x-1/2 w-4 h-4 bg-white border-2 border-gray-800 rounded-full" style="display: none;"></div>
                        </div>
                        <div class="flex justify-between text-xs mt-1 px-1">
                            <span>16</span><span>18.5</span><span>25</span><span>30</span><span>40</span>
                        </div>
                    </div>

                    <!-- Recommended Weight Range --><div class="mt-6 text-center">
                        <p class="text-gray-700 font-medium text-base">
                            Your Recommended Weight Range: 
                            <span class="font-bold nutryfit-dark-green text-lg" id="recommended-weight-range">49.8 kg - 67.0 kg</span>
                        </p>
                        <p class="text-xs text-gray-500">(Based on a healthy BMI of 18.5 - 24.9)</p>
                    </div>

                    <!-- Weight Advice --><div id="advice-box" class="mt-4 p-3 rounded-lg bg-red-100">
                        <p id="weight-advice" class="text-center font-semibold text-red-800">
                            To reach a healthy weight, a loss of 
                            <span class="font-bold" id="weight-difference">22 kg</span>
                            is recommended.
                        </p>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer Image --><div class="mt-8 text-center">
            <img src="https://res.cloudinary.com/dzbuuzziz/image/upload/v1762568998/Group_52534_cyijej.png" alt="Nutryfit Footer Graphic" class="mx-auto w-full max-w-lg h-auto">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const weightInput = document.getElementById('weight-input');
            const heightInput = document.getElementById('height-input');
            const calculateButton = document.getElementById('calculate-button'); // Get the new button

            // Set initial values for inputs
            weightInput.value = 87; // Example initial value
            heightInput.value = 164; // Example initial value
            
            // Set initial state to "uncalculated"
            clearCalculations(); 

            // Add event listener for the new button
            if (calculateButton) {
                calculateButton.addEventListener('click', calculateBMI);
            }
        });

        function clearCalculations() {
            const bmiValueText = document.getElementById('bmi-value-text');
            const bmiCategoryText = document.getElementById('bmi-category-text');
            const bmiResultBg = document.getElementById('bmi-result-bg');
            const recommendedWeightRange = document.getElementById('recommended-weight-range');
            const adviceBox = document.getElementById('advice-box');
            const bmiMarker = document.getElementById('bmi-marker');

            if (!bmiValueText || !bmiCategoryText || !bmiResultBg || !recommendedWeightRange || !adviceBox || !bmiMarker) {
                console.warn("Elements not ready for clearing.");
                return;
            }

            bmiValueText.textContent = '--';
            bmiCategoryText.textContent = 'Click Calculate';
            bmiResultBg.className = 'text-center p-4 rounded-lg bg-gray-100 text-gray-800';
            recommendedWeightRange.textContent = '-- kg - -- kg';
            
            // Fix: Target the 'p' tag inside adviceBox
            const adviceParagraph = adviceBox.querySelector('p');
            if (adviceParagraph) {
                adviceParagraph.textContent = 'Enter weight and height, then click "Calculate BMI".';
                adviceParagraph.className = 'text-center font-semibold text-gray-800'; // Reset text color
            }
            adviceBox.className = 'mt-4 p-3 rounded-lg bg-gray-100 text-gray-800';
            bmiMarker.style.display = 'none';
        }

        function calculateBMI() {
            const weightKg = parseFloat(document.getElementById('weight-input').value);
            const heightCm = parseFloat(document.getElementById('height-input').value);

            const bmiValueText = document.getElementById('bmi-value-text');
            const bmiCategoryText = document.getElementById('bmi-category-text');
            const bmiResultBg = document.getElementById('bmi-result-bg');
            const recommendedWeightRange = document.getElementById('recommended-weight-range');
            
            // Fix: Get the advice box and its 'p' tag, remove 'weightDifferenceSpan'
            const adviceBox = document.getElementById('advice-box');
            const adviceParagraph = adviceBox.querySelector('p'); // Get the <p> tag
            const bmiMarker = document.getElementById('bmi-marker');

            // Check if all elements were found.
            if (!bmiValueText || !bmiCategoryText || !bmiResultBg || !recommendedWeightRange || !adviceBox || !adviceParagraph || !bmiMarker) {
                console.error("Critical elements missing for calculation.");
                return; 
            }

            if (isNaN(weightKg) || isNaN(heightCm) || weightKg <= 0 || heightCm <= 0) {
                // Use the clear function for the "not calculated" state
                clearCalculations();
                // Override the message slightly
                if(bmiCategoryText) bmiCategoryText.textContent = 'Enter valid values';
                return;
            }

            const heightM = heightCm / 100;
            const bmi = weightKg / (heightM * heightM);
            const formattedBMI = bmi.toFixed(1);

            let category = '';
            let bgColorClass = '';
            let textColorClass = '';
            let advice = '';
            let diffKg = 0;
            let markerPosition = 0; // percentage for BMI marker

            // BMI Categories
            const healthyMinBMI = 18.5;
            const healthyMaxBMI = 24.9;
            const minHealthyWeight = (healthyMinBMI * heightM * heightM).toFixed(1);
            const maxHealthyWeight = (healthyMaxBMI * heightM * heightM).toFixed(1);

            if (bmi < 18.5) {
                category = 'Underweight';
                bgColorClass = 'bg-blue-100';
                textColorClass = 'text-blue-800';
                diffKg = (minHealthyWeight - weightKg).toFixed(1);
                advice = `To reach a healthy weight, a gain of <span class="font-bold">${diffKg} kg</span> is recommended.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100; // 16 is min, 40 is max of bar
            } else if (bmi >= 18.5 && bmi <= 24.9) {
                category = 'Normal Weight';
                bgColorClass = 'bg-green-100';
                textColorClass = 'text-green-800';
                advice = `You are within a healthy weight range. Maintain your current lifestyle.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100;
            } else if (bmi >= 25 && bmi <= 29.9) {
                category = 'Overweight';
                bgColorClass = 'bg-orange-100';
                textColorClass = 'text-orange-800';
                diffKg = (weightKg - maxHealthyWeight).toFixed(1);
                advice = `To reach a healthy weight, a loss of <span class="font-bold">${diffKg} kg</span> is recommended.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100;
            } else if (bmi >= 30 && bmi <= 34.9) {
                category = 'Obese Class I';
                bgColorClass = 'bg-red-100';
                textColorClass = 'text-red-800';
                diffKg = (weightKg - maxHealthyWeight).toFixed(1);
                advice = `To reach a healthy weight, a loss of <span class="font-bold">${diffKg} kg</span> is recommended.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100;
            } else if (bmi >= 35 && bmi <= 39.9) {
                category = 'Obese Class II';
                bgColorClass = 'bg-red-200';
                textColorClass = 'text-red-900';
                diffKg = (weightKg - maxHealthyWeight).toFixed(1);
                advice = `To reach a healthy weight, a loss of <span class="font-bold">${diffKg} kg</span> is recommended.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100;
            } else {
                category = 'Obese Class III (Morbid)';
                bgColorClass = 'bg-red-300';
                textColorClass = 'text-red-900';
                diffKg = (weightKg - maxHealthyWeight).toFixed(1);
                advice = `To reach a healthy weight, a loss of <span class="font-bold">${diffKg} kg</span> is recommended.`;
                markerPosition = ((bmi - 16) / (40 - 16)) * 100;
            }

            bmiValueText.textContent = formattedBMI;
            bmiCategoryText.textContent = category;
            bmiResultBg.className = `text-center p-4 rounded-lg ${bgColorClass} ${textColorClass}`;
            recommendedWeightRange.textContent = `${minHealthyWeight} kg - ${maxHealthyWeight} kg`;
            
            // Fix: Update adviceBox and its 'p' tag
            adviceBox.className = `mt-4 p-3 rounded-lg ${bgColorClass}`;
            adviceParagraph.innerHTML = advice; // Set the innerHTML
            adviceParagraph.className = `text-center font-semibold ${textColorClass}`; // Set the text color

            // Position BMI marker
            markerPosition = Math.min(Math.max(markerPosition, 0), 100); // Keep within 0-100%
            bmiMarker.style.left = `${markerPosition}%`;
            bmiMarker.style.display = 'block';

             // Adjust text color for advice if background is red for print
             if (bgColorClass.includes('bg-red')) {
                adviceBox.querySelector('p').style.color = '#991b1b'; // Darker red for print
            } else {
                adviceBox.querySelector('p').style.color = ''; // Reset
            }
        }
    </script>
</body>
</html>